!function(){angular.module("firebaseHelper",["firebase"]).factory("$firebaseJoin",["$firebaseUtils","$firebaseArray","$firebaseObject","$q","$log",function(e,r,t,n,i){var o={};return function(i,a){a=a||i;var u=r.prototype,c=e.defer(),s=[],l=r.$extend({$add:function(r){this._assertNotDestroyed("$add");var t=e.defer(),n=a.push(e.toJSON(r),e.makeNodeResolver(t)),o=n.key();return null!==o?t.promise.then(function(){return e.doSet(i.child(o),o).then(function(){return n})}):e.reject("Error adding new record; could not determine new key for "+r)},$save:function(r){this._assertNotDestroyed("$save");var t=this,n=t._resolveItem(r),i=t.$keyAt(n);if(null!==i){var o=a.child(i);return e.doSet(o,e.toJSON(n)).then(function(){return t.$$notify("child_changed",i),o})}return e.reject("Invalid record; could determine key for "+r)},$remove:function(r){this._assertNotDestroyed("$remove");var t=this.$keyAt(r);return null!==t?e.doRemove(a.child(t)).then(function(){return e.doRemove(i.child(t))}):e.reject("Invalid record; could not determine key for "+r)},$link:function(r){return e.doSet(i.child(r),r)},$unlink:function(e){return u.$remove.apply(this,arguments)},$$added:function(e){var r=a.child(e.key()),n="object"+r.path.toString(),i=o[n]||(o[n]=t(r));return s.push(i.$loaded()),i},$loaded:function(e,r){var t=this,i=c.promise;return arguments.length&&(i=i.then.call(i,e,r)),u.$loaded.call(this).then(function(){n.all(s).then(function(){c.resolve(t.$list)})["catch"](function(){c.reject("Could not load all value objects.")})})["catch"](function(e){c.reject(e)}),i}}),f="join"+i.path.toString()+"+"+a.path.toString();return o[f]||(o[f]=new l(i))}}]).provider("$firebaseHelper",function(){var e="",r=!1,t={};this.namespace=function(r){return void 0!==r&&(e=r),e},this.demo=function(e){return void 0!==e&&(r=e),r};var n=this.url=function(){if(!e)throw new Error("Firebase namespace not set, configure $firebaseHelperProvider.namespace('my-app') before using $firebaseHelper.");return"https://"+e+".firebaseio"+(r?"-demo":"")+".com/"},i=function(e){return e.replace(/^\/+/,"")};this.$get=["$firebaseAuth","$firebaseArray","$firebaseObject","$firebaseJoin","$q",function(e,r,o,a,u){var c=this,s=c.get=function(e,u){var c,l=u||"ref";if(angular.isString(e))c=new Firebase(n()+i(e));else if(angular.isObject(e))if(angular.isFunction(e.$ref))c=e.$ref();else if(angular.isFunction(e.child))c=e;else if(angular.isArray(e)&&e.length)if(angular.isString(e[0]))c=new Firebase(n()+i(e.join("/")));else{var f=s(e.shift()),d=i(e.join("/"));c=d?f.child(d):f}if(c||(c=new Firebase(n())),l+=c.path.toString(),t[l])return t[l];switch(u){default:case"ref":return t[l]=c;case"object":return t[l]=o(c);case"array":return t[l]=r(c);case"join":return t[l]=a(c)}};return c.auth=function(){return e(s(Array.prototype.slice.call(arguments)))},c.path=function(e){return s(e).path.toString()},c.ref=function(){return s(Array.prototype.slice.call(arguments))},c.object=function(){var e=Array.prototype.slice.call(arguments),r="object";return e[e.length-1]===!0&&(r="array",e.pop()),s(e,r)},c.array=function(){var e=Array.prototype.slice.call(arguments);return e.push(!0),c.object.apply(this,e)},c.join=function(e,r){return a(s(e),void 0!==r?s(r):void 0)},c.load=function(){return c.object.apply(this,arguments).$loaded()},c}]})}();