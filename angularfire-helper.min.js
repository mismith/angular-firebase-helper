angular.module("firebaseHelper",["firebase"]).provider("$firebaseHelper",function(){var a="",b={};this.namespace=function(b){return void 0!==b&&(a=b),a},this.$get=["$firebase","$firebaseAuth","$q",function(c,d,e){var f=this;return f.auth=function(a){return void 0===a?a=f.ref():angular.isString(a)?a=f.ref(a):angular.isFunction(a.$ref)&&(a=a.$ref),d(a)},f.ref=function(){var c=Array.prototype.slice.call(arguments),d="Ref/"+c.join("/");if(b[d])return b[d];var e=new Firebase("https://"+a+".firebaseio.com/"+(c.join("/")||""));return b[d]=e,e},f.inst=function(){if(1==arguments.length&&arguments[0]instanceof Firebase){var a=arguments[0],d="Inst"+a.path;if(b[d])return b[d];var e=c(a);return b[d]=e,e}var g=Array.prototype.slice.call(arguments),d="Inst/"+g.join("/");if(b[d])return b[d];var e=c(f.ref.apply(this,g));return b[d]=e,e},f.object=function(){var a=Array.prototype.slice.call(arguments),c="Object";a[a.length-1]===!0&&(c="Array",a.pop());var d=c+"/"+a.join("/");if(b[d])return b[d];var e=f.inst.apply(this,a)["$as"+c]();return b[d]=e,e},f.array=function(){var a=Array.prototype.slice.call(arguments);return a.push(!0),f.object.apply(this,a)},f.load=function(){return f.object.apply(this,arguments).$loaded()},f.child=function(){var a=Array.prototype.slice.call(arguments),b=a.shift();return angular.isFunction(b.$inst)&&(b=b.$inst()),angular.isFunction(b.$ref)&&(b=b.$ref()),angular.isFunction(b.child)?f.inst(b.child(a.join("/"))):b},f.populate=function(a,b,c){var d=[],g=f.ref(a);return g.once("value",function(a){angular.isObject(a.val())||angular.isFunction(c)&&c()}),g.on("child_added",function(a){var g=f.object(b,a.key());g.$loaded().then(function(){var a=[];angular.isFunction(c)&&a.push(c(g)),e.all(a).then(function(){d.push(g)})})}),g.on("child_removed",function(a){var b=-1,c=a.key();angular.forEach(d,function(a,d){b>=0||a.$id==c&&(b=d)}),b>=0&&d.splice(b,1)}),d},f.intersect=function(a,b,d,e){if(!Firebase.util)throw new Error("$firebaseHelper.intersect requires Firebase.util external library. See: https://github.com/firebase/firebase-util");var g={ref:f.ref(a)},h={ref:f.ref(b)};return d&&(g.keyMap=d),e&&(h.keyMap=e),c(Firebase.util.intersection(g,h)).$asArray()},f}]});