angular.module("firebaseHelper",["firebase"]).provider("$firebaseHelper",function(){var e="",r=!1,n={};this.namespace=function(r){return void 0!==r&&(e=r),e},this.demo=function(e){return void 0!==e&&(r=e),r};var t=this.url=function(){if(!e)throw new Error("Firebase namespace not set, configure $firebaseHelperProvider.namespace('my-app') before using $firebaseHelper.");return"https://"+e+".firebaseio"+(r?"-demo":"")+".com/"},a=function(e){return e.replace(/^\/+/,"")};this.$get=["$firebase","$firebaseAuth","$q",function(e,r,i){var u=this,s=u.$get=["input","as",function(r,i){var u,o=i;if(angular.isString(r))u=e(new Firebase(t()+a(r)));else if(angular.isArray(r)){if(r.length)if(angular.isString(r[0]))u=e(new Firebase(t()+a(r.join("/"))));else{var c=r.shift(),l=s(c,"ref");l=l.child(a(r.join("/"))),u=e(l)}}else angular.isObject(r)&&(angular.isFunction(r.$inst)?u=r.$inst():angular.isFunction(r.$ref)?u=r:angular.isFunction(r.child)&&(u=e(r)));if(u||(u=e(new Firebase(t()))),o+=u.$ref().path.toString(),n[o])return n[o];switch(i){case"ref":return n[o]=u.$ref();default:case"inst":return n[o]=u;case"object":return n[o]=u.$asObject();case"array":return n[o]=u.$asArray()}}];return u.auth=function(){return r(s(Array.prototype.slice.call(arguments),"ref"))},u.ref=function(){return s(Array.prototype.slice.call(arguments),"ref")},u.inst=function(){return s(Array.prototype.slice.call(arguments),"inst")},u.object=function(){var e=Array.prototype.slice.call(arguments),r="object";return e[e.length-1]===!0&&(r="array",e.pop()),s(e,r)},u.array=function(){var e=Array.prototype.slice.call(arguments);return e.push(!0),u.object.apply(this,e)},u.load=function(){return u.object.apply(this,arguments).$loaded()},u.populate=function(e,r,n){var t=[],a=s(e,"ref");return a.once("value",function(e){angular.isObject(e.val())||angular.isFunction(n)&&n()}),a.on("child_added",function(e){var a=s([r,e.key()],"object");a.$loaded().then(function(){var e=[];angular.isFunction(n)&&e.push(n(a)),i.all(e).then(function(){t.push(a)})})}),a.on("child_removed",function(e){var r=-1,n=e.key();angular.forEach(t,function(e,t){r>=0||e.$id==n&&(r=t)}),r>=0&&t.splice(r,1)}),t},u.intersect=function(r,n,t,a){if(!Firebase.util)throw new Error("$firebaseHelper.intersect() requires the `Firebase.util` external library. See: https://github.com/firebase/firebase-util");var i={ref:u.ref(r)},s={ref:u.ref(n)};return t&&(i.keyMap=t),a&&(s.keyMap=a),e(Firebase.util.intersection(i,s)).$asArray()},u}]});