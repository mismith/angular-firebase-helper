angular.module("firebaseHelper",["firebase"]).service("$firebaseHelper",["$firebase","$firebaseAuth","$q",function(a,b,c){var d=this,e="",f={};return d.namespace=function(a){return void 0!==a&&(e=a),e},d.auth=function(a){return void 0===a?a=d.ref():angular.isString(a)?a=d.ref(a):angular.isFunction(a.$ref)&&(a=a.$ref),b(a)},d.ref=function(){var a=Array.prototype.slice.call(arguments),b="Ref/"+a.join("/");if(f[b])return f[b];var c=new Firebase("https://"+e+".firebaseio.com/"+(a.join("/")||""));return f[b]=c,c},d.inst=function(){if(1==arguments.length&&arguments[0]instanceof Firebase){var b=arguments[0],c="Inst"+b.path;if(f[c])return f[c];var e=a(b);return f[c]=e,e}var g=Array.prototype.slice.call(arguments),c="Inst/"+g.join("/");if(f[c])return f[c];var e=a(d.ref.apply(this,g));return f[c]=e,e},d.object=function(){var a=Array.prototype.slice.call(arguments),b="Object";a[a.length-1]===!0&&(b="Array",a.pop());var c=b+"/"+a.join("/");if(f[c])return f[c];var e=d.inst.apply(this,a)["$as"+b]();return f[c]=e,e},d.array=function(){var a=Array.prototype.slice.call(arguments);return a.push(!0),d.object.apply(this,a)},d.load=function(){return d.get.apply(this,arguments).$loaded()},d.child=function(){var a=Array.prototype.slice.call(arguments),b=a.shift();return angular.isFunction(b.$inst)&&(b=b.$inst()),angular.isFunction(b.$ref)&&(b=b.$ref()),angular.isFunction(b.child)?d.inst(b.child(a.join("/"))):b},d.populate=function(a,b,e){var f=[],g=d.ref(a);return g.once("value",function(a){angular.isObject(a.val())||angular.isFunction(e)&&e()}),g.on("child_added",function(a){var g=d.get(b,a.key());g.$loaded().then(function(){var a=[];angular.isFunction(e)&&a.push(e(g)),c.all(a).then(function(){f.push(g)})})}),g.on("child_removed",function(a){var b=-1,c=a.key();angular.forEach(f,function(a,d){b>=0||a.$id==c&&(b=d)}),b>=0&&f.splice(b,1)}),f},d.intersect=function(b,c,e,f){if(!Firebase.util)throw new Error("$firebaseHelper.intersect requires Firebase.util external library. See: https://github.com/firebase/firebase-util");var g={ref:d.ref(b)},h={ref:d.ref(c)};return e&&(g.keyMap=e),f&&(h.keyMap=f),a(Firebase.util.intersection(g,h)).$asArray()},d}]);